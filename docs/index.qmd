---
title: "abschlussprojekt_areggerroman"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r}
library(tidyverse)
library(janitor)
# Paket aktivieren
library(readODS)
library(here)
```

```{r}
daten_in <- read_csv(here::here("daten/raw/ts-x-15.02.04.04_detail (2).csv")) |>
  janitor::clean_names() 
```

```{r}
# ods-Datei ".ods" importieren
code_sex <- read_ods("daten/raw/ts-x-15.02.04.04_detail-APPENDIX.ods", sheet = "SEX") |> 
  select(CODE, LABEL_DE)

code_uni <- read_ods("daten/raw/ts-x-15.02.04.04_detail-APPENDIX.ods", sheet = "UNI") |> 
  select(CODE, LABEL_DE)

code_field <- read_ods("daten/raw/ts-x-15.02.04.04_detail-APPENDIX.ods", sheet = "FIELD") |> 
  select(CODE, LABEL_DE)

code_level <- read_ods("daten/raw/ts-x-15.02.04.04_detail-APPENDIX.ods", sheet = "LEVEL") |> 
  select(CODE, LABEL_DE)

```

```{r}
# daten transformation

daten_processed <- daten_in |> 
  left_join(code_sex, by = c("sex" = "CODE")) |> 
  select(-sex) |> 
  rename(sex = LABEL_DE) |> 
  left_join(code_uni, by = c("uni" = "CODE")) |> 
  select(-uni) |> 
  rename(uni = LABEL_DE) |> 
  left_join(code_field, by = c("field" = "CODE")) |> 
  select(-field) |> 
  rename(field = LABEL_DE) |> 
  left_join(code_level, by = c("level" = "CODE")) |> 
  select(-level) |> 
  rename(level = LABEL_DE) |> 
  left_join(code_period, by = c("period" = "CODE")) |> 
  select(-period) |> 
  rename(period = LABEL_DE) |> 
  
```

```{r}
#1. Versuch, Daten zusammenzustellen
daten_processed |> 
  group_by(sex, period) |> 
  summarise(count = sum(value)) |> 
  ggplot(aes(x = period, y = count, color = sex, group = sex)) +
  geom_point() +
  geom_line()

#Alternative zu vorangehendem Code
daten_processed |> 
  count(sex, period, wt = value) |> 
  ggplot(aes(x = period, y = n, color = sex, group = sex)) +
  geom_point() +
  geom_line()
```

```{r}
#Hier werden verschiedene Daten zusammengestellt, um Grafiken zu generieren
#Wieviele Frauen und Männer studieren seit 2000/01 in unterschiedlichen Feldern?
daten_processed |>
  group_by(field, sex) |>
  summarise(count =sum(value))

#Wieviele Frauen und Männer studieren im letzten Jahr in unterschiedlichen Feldern?
daten_processed_projahr <- daten_processed |>
  group_by(field, sex) |>
  summarise(count =sum(value))

#2. Versuch: Wieviele Frauen und Männer studieren im letzten Jahr in unterschiedlichen Feldern?
daten_processed_projahr <- daten_processed |>
  group_by(period, sex) |>
  summarise(count =sum(value))

#Installation Dplyr für Filterfunktionen
#install.packages("dplyr") -->entfernt, damit das Package nicht bei jedem Rendern neu geladen wird.
library(dplyr)

daten_processed_projahr_neu <- daten_processed |> 
  filter("period" == 2024/25)

#Mit der folgenden Grafik wird ersichtlich, wieviele studierende Männer und Frauen sich pro Studienjahr in einem Studium befinden und wie sich die Zahlen über die Jahre hinweg entwickelt haben.
ggplot(data = daten_processed, aes(x = period, y = value, fill = sex)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.5),
           color = "black",
           size = 0) +
  geom_text(aes(label = value), 
            position = position_dodge(width = 0.5), 
            vjust = -0.5,
            color = "black") +
  labs(title = "Anzahl der Männer und Frauen pro Studienjahr",
       x = "Studienjahr",
       y = "Anzahl") +
  scale_fill_manual(values = c("Mann" = "blue", "Frau" = "red")) +
  theme_minimal()

```





```{r}
#Mit dieser Grafik sehe ich, wie sich die Geschlechter innerhalb jedes Fachgebiets verhältnismässig verteilen.
ggplot(daten_processed, aes(x = field, fill = sex)) +
  geom_bar(position = "fill") +
  labs(title = "Relative Verteilung der Geschlechter nach Fach",
       x = "Fachgebiet", y = "Anteil") +
  scale_y_continuous(labels = scales::percent) +
  theme_minimal() +
  coord_flip()

```









# Einleitung

Das Ziel ist, aus Bildungsdatensatz einige Erkenntnisse zu gewinnen und diese grafisch darzustellen. Dies deckt sich mit meiner aktuellen Tätigkeit, wird hier aber mit einem öffentlichen Datensatz des Bundesamts für Statistik generiert. Der Datensatz soll Erkenntnisse darüber liefern, wie Männer und Frauen  Weiterbildungsstudiengänge an Schweizer Hochschulen besuchen, insbesondere auch im Hinblick auf verschiedene Themenfelder (fields). 

## Daten

## Analyseziele

# Daten Aufbereitung

# Daten Visualisierung
